Index: gvsun-business/provider-api/usercenter-front/src/main/resources/static/modules/configcenter/registration/editAcademicStudentWorkAchievement.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>const evaluationHost =apiGateWayHost+\"/configcenter/\";\r\nvar checked=new Array();\r\nlayui.config({\r\n\tbase:'../../'\r\n}).extend({\r\n\tindex:'lib/index'\r\n}).use(['index','form', 'element', 'laydate', 'laypage', 'table', 'layer', 'layedit', 'upload'], function() {\r\n\tvar $ = layui.jquery,\r\n\t\tadmin = layui.admin,\r\n\t\tform = layui.form,\r\n\t\telement = layui.element,\r\n\t\tlaydate = layui.laydate,\r\n\t\tlaypage = layui.laypage,\r\n\t\ttable = layui.table,\r\n\t\tlayer = layui.layer,\r\n\t\tlayedit = layui.layedit,\r\n\t\tupload = layui.upload;\r\n\r\n\tlet timetableId;\r\n\tlet results;\r\n\tlet resultId;\r\n\tvar editorIndexs = [];//副文本框\r\n\tvar uploadIndexs = [];//上传文件\r\n\tvar timetableProcessId;\r\n\t//向世界问个好\r\n\t//layer.msg('');\r\n\tlet configObj = {\r\n\t\tselectConfig : [],//记录配置项为单选下拉框的下标\r\n\t\tmultiSelectConfig : [],//记录配置项为多选下拉框的下标\r\n\t\tinputConfig : [],//记录配置项为输入框的下标\r\n\t\turlConfig : [],//记录配置项为外链的下标\r\n\t\ttextConfig : [],//记录配置项为多行文本框的下标\r\n\t\tfileConfig : [],//记录配置项为附件的下标\r\n\t\tdateConfig : [],//记录配置项为日期的下标\r\n\t\tdateTimeConfig : [],//记录配置项为日期时间的下标\r\n\t\trangeDateConfig : [],//记录配置项为范围日期的下标\r\n\t\trangeTimeConfig : [],//记录配置项为范围时间的下标\r\n\t\trangeDateTimeConfig : [],//记录配置项为范围日期+时间的下标\r\n\t\tradioConfig : [],//记录配置项为单选框的下标\r\n\t\tlinkageConfig : [],////记录需要联动的配置项\r\n\t\tcheckboxConfig : [],//记录配置项为多选框的下标\r\n\t\tmessageConfig : [],//记录配置项为发送短信/邮箱的下标\r\n\t\tauditConfig : [],//记录配置项为审核的下标\r\n\t\teditorConfig : [],//记录配置项为副文本框的下标\r\n\t}\r\n\t// form.render(null, 'editacademicstudentworklogbox');\r\n\t//\r\n\t// //信息\r\n\t// form.val('editacademicstudentworklogbox', {\r\n\t// \t\"\": \"\" //备用\r\n\t// });\r\n\tlet getTimetableId = new Promise((resolve, reject) => {\r\n\t\t$.ajax({\r\n\t\t\turl: `${evaluationHost}api/timetableProcess/usersByCurrentUser`,\r\n\t\t\ttype:'get',\r\n\t\t\tdata:{username: currentUsername,typeName: 'academicAdvisor',type: 'INITIATOR',page: 1,limit: 1},\r\n\t\t\tasync: false,\r\n\t\t\tsuccess:function (res){\r\n\t\t\t\t// console.log(res);\r\n\t\t\t\ttimetableId = res.data.timetableProcessInitiatorDTOS[0].timetableId;\r\n\t\t\t\tresolve('getTimetableId Success')\r\n\t\t\t\t// getNextConfigInfo();\r\n\t\t\t},\r\n\t\t\terror:function () {\r\n\t\t\t\tlayer.msg(\"获取学生相关信息失敗！\");\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t})\r\n\tlet getResultByTimetableId = new Promise((resolve, reject) => {\r\n\t\t$.ajax({\r\n\t\t\turl: evaluationHost + 'api/timetable/info?timetableId=' + timetableId,\r\n\t\t\tdataType: 'json',\r\n\t\t\tasync: false,\r\n\t\t\ttype: 'get',\r\n\t\t\tsuccess: function (res) {\r\n\t\t\t\t// console.log(res);\r\n\t\t\t\ttimetableProcessId = res.data[0].timetableProcessDTOS[3].timetableProcessId;\r\n\t\t\t\t// //获取表单\r\n\t\t\t\t// let formstr = '';\r\n\t\t\t\t// formstr = configString(res.data[0].timetableProcessDTOS[3]);\r\n\t\t\t\t// $('.editachievementbox').find('.layui-row').html(formstr);\r\n\t\t\t\t//获取结果\r\n\t\t\t\tlet resultstr = '';\r\n\t\t\t\t$.each(res.data[0].timetableProcessDTOS[3].timetableResults,function (key, value) {\r\n\t\t\t\t\tif(value.initiatorUsername === currentUsername){\r\n\t\t\t\t\t\tresultstr+=getWorkResult(res.data[0].timetableProcessDTOS[3].configIndicators,value);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t$('.case_box').html(resultstr);\r\n\t\t\t\t// configRender();\r\n\t\t\t\tresolve('getResult Success')\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t})\r\n\tPromise.all([getTimetableId, getResultByTimetableId]).then((result) => {\r\n\t\tconsole.log(result)\r\n\t}).catch((error) => {\r\n\t\tconsole.log(error)\r\n\t})\r\n\t//信息\r\n\t// form.val('editacademicstudentworkachievementbox', {\r\n\t// \t\"name\": \"我是名称\",\r\n\t// \t\"info\": \"我是简介/我是简介/我是简介/我是简介/我是简介/\",\r\n\t// \t\"teaminfo\": \"我是团队介绍/我是团队介绍/我是团队介绍/我是团队介绍/我是团队介绍/\",\r\n\t// });\r\n//监听提交\r\n\tform.on('submit(saveachievementboxbtn)', function(data) {\r\n\r\n\t\tvar d1 = data.field;\r\n\t\tvar configIndicatorDTOss = [];\r\n\t\t// console.log(d1);\r\n\t\t$.each(configObj.multiSelectConfig,function (index,item){\r\n\t\t\tvar xmList = xmSelect.get('#multiSelectConfig'+item.index);\r\n\t\t\tvar valueArr = xmList[0].getValue('value');\r\n\t\t\tvar nameArr = xmList[0].getValue('name');\r\n\t\t\tvar str = '';\r\n\t\t\t$.each(valueArr,function (i,d) {\r\n\t\t\t\tstr+=d+'_'+nameArr[i]+',';\r\n\t\t\t});\r\n\t\t\tstr = str.slice(0,str.length-1);\r\n\t\t\t// d1['evaluationScore'+item.index] = xmList[0].getValue('valueStr')+'_'+xmList[0].getValue('nameStr')\r\n\t\t\td1['evaluationScore'+item.index] = str;\r\n\t\t});\r\n\t\t$.each(configObj.selectConfig,function (index,item) {\r\n\t\t\td1['evaluationScore'+item.index] += '_'+$('#selectConfig'+item.index).find(\"option:selected\").text();\r\n\t\t});\r\n\t\t$.each(configObj.checkboxConfig,function (index,item) {\r\n\t\t\tlet tasks = '';\r\n\t\t\t$('input[name=\"evaluationScore'+ item.index +'\"]:checked').each(function() { //遍历所有被选中的name为selectFlag的 checkbox\r\n\t\t\t\ttasks+=$(this).val()+'_'+$(this).attr('title')+',';\r\n\t\t\t});\r\n\t\t\ttasks = (tasks.substring(tasks.length - 1) == ',') ? tasks.substring(0, tasks.length - 1) : tasks\r\n\t\t\td1['evaluationScore'+item.index] = tasks;\r\n\t\t});\r\n\t\t$.each(configObj.urlConfig,function (index,item) {\r\n\t\t\tif(item.type.indexOf('|pay|')!=-1){\r\n\t\t\t\tvar isPay = $('#evaluationScore'+item.index).attr('data');\r\n\t\t\t\td1['evaluationScore'+item.index] = isPay;\r\n\t\t\t}else {\r\n\t\t\t\td1['evaluationScore'+item.index] = $('#evaluationScore'+item.index).attr('href')\r\n\t\t\t}\r\n\t\t});\r\n\t\t// console.log(d1);\r\n\t\tsaveTimetable(d1);\r\n\t});\r\n\tfunction saveTimetable(d1) {\r\n\t\tlet timetableResultDTO = new Object();\r\n\t\td1['timetableProcessId'] = timetableProcessId;\r\n\t\td1['initiatorUsername'] = currentUsername;\r\n\t\ttimetableResultDTO['timetableResult'] = d1;\r\n\t\ttimetableResultDTO['submitUser'] = currentUsername;\r\n\t\ttimetableResultDTO['stageId'] = 1;\r\n\t\ttimetableResultDTO['isComplete'] = -1;\r\n\t\ttimetableResultDTO['timetableProcessId'] = timetableProcessId;\r\n\t\tvar data = JSON.stringify(timetableResultDTO);\r\n\t\t// 保存\r\n\t\t$.ajax({\r\n\t\t\t// url:zuulUrl+'api/meetingProcess/saveMeetingProcess',\r\n\t\t\turl:evaluationHost+'api/timetableResult/resultNew',\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: data,\r\n\t\t\ttype: 'post',\r\n\t\t\t// async: false,\r\n\t\t\tcontentType:\"application/json;charset=utf-8\",\r\n\t\t\tsuccess:function (res) {\r\n\t\t\t\t// console.log(res);\r\n\t\t\t\tif(res.code == '200'){\r\n\t\t\t\t\tlayer.msg('保存成功');\r\n\t\t\t\t\t$(\".showachievementbox\").show();\r\n\t\t\t\t\t$(\".editachievementbox\").hide();\r\n\t\t\t\t}else{\r\n\t\t\t\t\tlayer.msg(res.msg);\r\n\t\t\t\t\treturn false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function () {\r\n\t\t\t\talert(\"后台保存数据报错\");\r\n\t\t\t\treturn false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t//上传文件，选完文件后不自动上传,点击开始上传按钮上传\r\n\r\n\r\n\tfunction configString(data) {\r\n\t\tlet str = '';\r\n\t\t$.each(data,function (key, value) {\r\n\t\t\tif(value.contentType === 'input'){\r\n\t\t\t\tstr+=`<div class=\"layui-col-lg12\">\r\n\t\t\t\t\t\t\t<label class=\"layui-form-label\">${value.indicatorCname}</label>\r\n\t\t\t\t\t\t\t<div class=\"layui-input-block\">\r\n\t\t\t\t\t\t\t\t<input type=\"text\" name=\"evaluationScore${key+1}\"  autocomplete=\"on\" class=\"layui-input\" lay-verify=\"required\" placeholder=\"请输入${value.indicatorCname}\">\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>`\r\n\t\t\t}else if(value.contentType === 'editor'){\r\n\t\t\t\tconfigObj.editorConfig.push({index:key+1,indicatorName: value.indicatorName ? value.indicatorName : ''});\r\n\t\t\t\tstr+=`<div class=\"layui-col-lg12\">\r\n\t\t\t\t\t\t\t<label class=\"layui-form-label\">${value.indicatorCname}</label>\r\n\t\t\t\t\t\t\t<div class=\"layui-input-block\">\r\n\t\t\t\t\t\t\t\t<textarea id=\"editorConfig${key+1}\" name=\"evaluationScore${key+1}\" style=\"display: none;\" lay-verify=\"content\"></textarea>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>`\r\n\t\t\t}else if(value.contentType === 'number'){\r\n\t\t\t\tstr+=`<div class=\"layui-col-lg12\">\r\n\t\t\t\t\t\t\t<label class=\"layui-form-label\">${value.indicatorCname}</label>\r\n\t\t\t\t\t\t\t<div class=\"layui-input-block\">\r\n\t\t\t\t\t\t\t\t<input type=\"number\" name=\"evaluationScore${key+1}\" autocomplete=\"on\" class=\"layui-input\" lay-verify=\"required\" placeholder=\"请输入${value.indicatorCname}\">\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>`\r\n\t\t\t}else if(value.contentType === 'date'){\r\n\t\t\t\tconfigObj.dateConfig.push({index:key+1,indicatorName: value.indicatorName ? value.indicatorName : ''});\r\n\t\t\t\tstr+=`<div class=\"layui-col-lg12\">\r\n\t\t\t\t\t\t\t<label class=\"layui-form-label\">${value.indicatorCname}</label>\r\n\t\t\t\t\t\t\t<div class=\"layui-input-block\">\r\n\t\t\t\t\t\t\t\t<input type=\"imput\" id=\"dateConfig${key+1}\" name=\"evaluationScore${key+1}\" autocomplete=\"on\" class=\"layui-input\" lay-verify=\"required\" placeholder=\"请选择${value.indicatorCname}\">\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>`\r\n\t\t\t}else if(value.contentType === 'dateTime'){\r\n\t\t\t\tconfigObj.dateTimeConfig.push({index:key+1,indicatorName: value.indicatorName ? value.indicatorName : ''});\r\n\t\t\t\tstr+=`<div class=\"layui-col-lg12\">\r\n\t\t\t\t\t\t\t<label class=\"layui-form-label\">${value.indicatorCname}</label>\r\n\t\t\t\t\t\t\t<div class=\"layui-input-block\">\r\n\t\t\t\t\t\t\t\t<input type=\"imput\" id=\"dateTimeConfig${key+1}\" name=\"evaluationScore${key+1}\" autocomplete=\"on\" class=\"layui-input\" lay-verify=\"required\" placeholder=\"请选择${value.indicatorCname}\">\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>`\r\n\t\t\t}else if(value.contentType === 'rangeDate'){\r\n\t\t\t\tconfigObj.rangeDateConfig.push({index:key+1,indicatorName: value.indicatorName ? value.indicatorName : ''});\r\n\t\t\t\tstr+=`<div class=\"layui-col-lg12\">\r\n\t\t\t\t\t\t\t<label class=\"layui-form-label\">${value.indicatorCname}</label>\r\n\t\t\t\t\t\t\t<div class=\"layui-input-block\">\r\n\t\t\t\t\t\t\t\t<input type=\"imput\" id=\"rangeDateConfig${key+1}\" name=\"evaluationScore${key+1}\" autocomplete=\"on\" class=\"layui-input\" lay-verify=\"required\" placeholder=\"请选择${value.indicatorCname}\">\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>`\r\n\t\t\t}else if(value.contentType === 'rangeDateTime'){\r\n\t\t\t\tconfigObj.rangeDateTimeConfig.push({index:key+1,indicatorName: value.indicatorName ? value.indicatorName : ''});\r\n\t\t\t\tstr+=`<div class=\"layui-col-lg12\">\r\n\t\t\t\t\t\t\t<label class=\"layui-form-label\">${value.indicatorCname}</label>\r\n\t\t\t\t\t\t\t<div class=\"layui-input-block\">\r\n\t\t\t\t\t\t\t\t<input type=\"imput\" id=\"rangeDateTimeConfig${key+1}\" name=\"evaluationScore${key+1}\" autocomplete=\"on\" class=\"layui-input\" lay-verify=\"required\" placeholder=\"请选择${value.indicatorCname}\">\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>`\r\n\t\t\t}else if(value.contentType === 'multiSelect'){\r\n\t\t\t\tconfigObj.multiSelectConfig.push({index: (key + 1), url: value.url, configIndicatorDTOS: value.configIndicatorDTOS, type: value.indicatorName ? value.indicatorName : ''});\r\n\t\t\t\tstr+=`<div class=\"layui-col-lg12\">\r\n\t\t\t\t\t\t\t<label class=\"layui-form-label\">${value.indicatorCname}</label>\r\n\t\t\t\t\t\t\t<div class=\"layui-input-block\">\r\n\t\t\t\t\t\t\t\t<div id=\"multiSelectConfig${key+1}\" class=\"xm-select-demo\"></div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>`\r\n\t\t\t}else if(value.contentType === 'select'){\r\n\t\t\t\tlet selectObject = new Object();\r\n\t\t\t\tselectObject['index'] = key+1;\r\n\t\t\t\tselectObject['url'] = value.url;\r\n\t\t\t\tselectObject['type'] = value.indicatorName ? value.indicatorName : '';\r\n\t\t\t\tselectObject['id'] = value.id;\r\n\t\t\t\tselectObject['configIndicatorDTOS'] = value.configIndicatorDTOS;\r\n\t\t\t\tif (value.indicatorName && value.indicatorName.indexOf('|linkage') != -1) {\r\n\t\t\t\t\tfor (var j = 0; j < value.indicatorName.split('|').length; j++) {\r\n\t\t\t\t\t\tif (value.indicatorName.split('|')[j].indexOf('linkage') != -1) {\r\n\t\t\t\t\t\t\tselectObject['parentId'] = value.indicatorName.split('|')[j].replace(/[^0-9]/ig, \"\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tselectObject['linkageType'] = 'select';\r\n\t\t\t\t\tconfigObj.linkageConfig.push(selectObject);\r\n\t\t\t\t}\r\n\t\t\t\tconfigObj.selectConfig.push(selectObject)\r\n\t\t\t\tstr+=`<div class=\"layui-col-lg12\">\r\n\t\t\t\t\t\t\t<label class=\"layui-form-label\">${value.indicatorCname}</label>\r\n\t\t\t\t\t\t\t<div class=\"layui-input-block\">\r\n\t\t\t\t\t\t\t\t<select name=\"evaluationScore${key+1}\" id=\"selectConfig${key+1}\" lay-verify=\"required\" lay-filter=\"select${key+1}\" lay-search=\"\">\r\n\t\t\t\t\t\t\t\t\t<option value=\"\">请选择${value.indicatorCname}</option>\r\n\t\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>`\r\n\t\t\t}else if(value.contentType === 'text'){\r\n\t\t\t\tlet textObject = new Object();\r\n\t\t\t\ttextObject['index'] = (key + 1);\r\n\t\t\t\ttextObject['type'] = value.indicatorName ? value.indicatorName : '';\r\n\t\t\t\ttextObject['id'] = value.id;\r\n\t\t\t\ttextObject['url'] = value.url;\r\n\t\t\t\t// textConfig.push((index+1));\r\n\t\t\t\tif (value.indicatorName && value.indicatorName.indexOf('linkage') != -1) {\r\n\t\t\t\t\tfor (var j = 0; j < value.indicatorName.split('|').length; j++) {\r\n\t\t\t\t\t\tif (value.indicatorName.split('|')[j].indexOf('linkage') != -1) {\r\n\t\t\t\t\t\t\ttextObject['parentId'] = value.indicatorName.split('|')[j].replace(/[^0-9]/ig, \"\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttextObject['linkageType'] = 'text';\r\n\t\t\t\t\t// linkageType = 'text';\r\n\t\t\t\t\tstr += `<div class=\"layui-col-lg12\">\r\n\t \t\t\t\t\t\t\t<label class=\"layui-form-label\">${value.indicatorCname}</label>\r\n\t \t\t\t\t\t\t\t<div class=\"layui-input-block\">\r\n\t \t\t\t\t\t\t\t\t<textarea type=\"text\"  id=\"textConfig${key+1}\" name=\"evaluationScore${key+1}\"   placeholder=\"请填写${value.indicatorCname}\" autocomplete=\"on\" class=\"layui-textarea\" readonly=\"\" ></textarea>\r\n\t \t\t\t\t\t\t\t</div>\r\n\t \t\t\t\t\t\t</div>`;\r\n\t\t\t\t\tconfigObj.linkageConfig.push(textObject);\r\n\t\t\t\t}else {\r\n\t\t\t\t\tstr += `<div class=\"layui-col-lg12\">\r\n\t \t\t\t\t\t\t\t<label class=\"layui-form-label\">${value.indicatorCname}</label>\r\n\t \t\t\t\t\t\t\t<div class=\"layui-input-block\">\r\n\t \t\t\t\t\t\t\t\t<textarea type=\"text\"  id=\"textConfig${key+1}\" name=\"evaluationScore${key+1}\"   placeholder=\"请填写${value.indicatorCname}\" autocomplete=\"on\" class=\"layui-textarea\"></textarea>\r\n\t \t\t\t\t\t\t\t</div>\r\n\t \t\t\t\t\t\t</div>`;\r\n\t\t\t\t}\r\n\t\t\t\tconfigObj.textConfig.push(textObject);\r\n\t\t\t}else if (value.contentType == 'radio') {\r\n\t\t\t\tconfigObj.radioConfig.push({index: (key + 1), url: value.url, type: value.indicatorName ? value.indicatorName : ''});\r\n\t\t\t\tif (value.indicatorName && value.indicatorName.indexOf('audit')!=-1) {\r\n\t\t\t\t\t$('.stepInfo').click();\r\n\t\t\t\t\tconfigObj.auditConfig.push((key + 1));\r\n\t\t\t\t} else if (value.indicatorName && value.indicatorName.indexOf('|message|')!=-1){\r\n\t\t\t\t\tconfigObj.messageConfig.push((key + 1));\r\n\t\t\t\t}\r\n\t\t\t\tstr += `<div class=\"layui-col-lg12\">\r\n \t\t\t\t\t\t\t<label class=\"layui-form-label\">${value.indicatorCname}</label>\r\n \t\t\t\t\t\t\t<div class=\"layui-input-block\">`\r\n\t\t\t\tif(value.indicatorOptions ==  null||value.indicatorOptions==''){\r\n\t\t\t\t\tstr+=`<input type=\"radio\" name=\"evaluationScore${key+1}\" value=\"1\" title=\"是\">\r\n\t\t\t\t\t      <input type=\"radio\" name=\"evaluationScore${key+1}\" value=\"0\" title=\"否\">`;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tlet options = value.indicatorOptions.indexOf(',')!=-1?value.indicatorOptions.split(','):value.indicatorOptions.split('，');\r\n\t\t\t\t\t$.each(options,function (j,o) {\r\n\t\t\t\t\t\tstr+=`<input type=\"radio\" name=\"evaluationScore${key+1}\" value=\"${j+1}\" title=\"${o}\">`\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\t// '<input type=\"text\" id=\"isAudit'+ templateId +'\" name=\"isAudit'+ templateId +'\"  lay-verify=\"required\" placeholder=\"请选择'+ item.indicatorCname +'\" autocomplete=\"off\" class=\"layui-input\" />' +\r\n\t\t\t\tstr+=`</div></div>`;\r\n\t\t\t}else if (value.contentType == 'checkbox') {\r\n\t\t\t\tconfigObj.checkboxConfig.push({index: (key + 1), url: value.url, type: value.indicatorName ? value.indicatorName : ''});\r\n\t\t\t\tstr += `<div class=\"layui-col-lg12\">\r\n \t\t\t\t\t\t\t<label class=\"layui-form-label\">${value.indicatorCname}</label>\r\n \t\t\t\t\t\t\t<div class=\"layui-input-block\" style=\"padding-top: 5px;\">`\r\n\t\t\t\tlet options = value.indicatorOptions.indexOf(',')!=-1?value.indicatorOptions.split(','):value.indicatorOptions.split('，');\r\n\t\t\t\t$.each(options,function (j,o) {\r\n\t\t\t\t\tstr+=`<input type=\"checkbox\" lay-skin=\"primary\" name=\"evaluationScore${key+1}\" value=\"${j+1}\" title=\"${o}\">`\r\n\t\t\t\t})\r\n\t\t\t\tstr+=`</div></div>`;\r\n\t\t\t}else if (value.contentType == 'file') {\r\n\t\t\t\tconfigObj.fileConfig.push({index: (key + 1), type: value.indicatorName ? value.indicatorName : ''});\r\n\t\t\t\tlet step = 0;\r\n\t\t\t\t$('.subentry_tab a').each(function () {\r\n\t\t\t\t\tif($(this).hasClass('field_btn_select'))\r\n\t\t\t\t\t\tstep = $(this).index()+1;\r\n\t\t\t\t})\r\n\t\t\t\tstr += `<div class=\"layui-col-lg12\">\r\n \t\t\t\t\t\t\t<label class=\"layui-form-label\">${value.indicatorCname}</label>\r\n \t\t\t\t\t\t\t<div class=\"layui-input-block\" style=\"padding-top: 5px;\">`\r\n\t\t\t\tstr+=`\r\n<!--<div class=\"mix_uploadbox\">\r\n// \t\t\t\t\t\t<div class=\"layui-upload\">\r\n// \t\t\t\t\t\t\t<div class=\"layui-upload-drag\" id=\"uploadFile${key + 1}\">\r\n// \t\t\t\t\t\t\t\t<i class=\"layui-icon\">\uE67C</i>\r\n// \t\t\t\t\t\t\t\t<p>点击选择文件，或将文件拖拽到此处</p>\r\n// \t\t\t\t\t\t\t</div>\r\n// \t\t\t\t\t\t\t<div class=\"layui-upload-list\">\r\n// \t\t\t\t\t\t\t\t<table class=\"layui-table\">\r\n// \t\t\t\t\t\t\t\t\t<thead>\r\n// \t\t\t\t\t\t\t\t\t\t<tr>\r\n// \t\t\t\t\t\t\t\t\t\t\t<th>文件名</th>\r\n// \t\t\t\t\t\t\t\t\t\t\t<th>大小</th>\r\n// \t\t\t\t\t\t\t\t\t\t\t<th>状态</th>\r\n// \t\t\t\t\t\t\t\t\t\t\t<th>操作</th>\r\n// \t\t\t\t\t\t\t\t\t\t</tr>\r\n// \t\t\t\t\t\t\t\t\t</thead>\r\n// \t\t\t\t\t\t\t\t\t<tbody id=\"pblist${key+1}\"></tbody>\r\n// \t\t\t\t\t\t\t\t</table>\r\n// \t\t\t\t\t\t\t\t<div class=\"upload_btn\">\r\n// \t\t\t\t\t\t\t\t\t<input type=\"button\" class=\"layui-btn\" id=\"uploadfilesbtn${key + 1}\" value=\"开始上传文件\" />\r\n// \t\t\t\t\t\t\t\t</div>\r\n// \t\t\t\t\t\t\t</div>\r\n// \t\t\t\t\t\t</div>\r\n// \t\t\t\t\t\t</div>-->\r\n<button type=\"button\" class=\"layui-btn\" onclick=\"uploadFileMeeting(${(key + 1)},3)\">上传附件</button>\r\n\t\t\t\t\t <input id=\"fileUpload${ (key + 1)}_3\" name=\"evaluationScore${ (key + 1)}\" class=\"layui-input layui-disabled\" disabled=\"\"/>\r\n\t\t\t\t\t </div></div>`;\r\n\t\t\t}else if(value.contentType === 'url'){\r\n\t\t\t\tlet urlObject = new Object();\r\n\t\t\t\turlObject['index'] = (key + 1);\r\n\t\t\t\turlObject['type'] = value.indicatorName ? value.indicatorName : '';\r\n\t\t\t\turlObject['id'] = value.id;\r\n\t\t\t\turlObject['url'] = value.url;\r\n\t\t\t\tif (value.indicatorName && value.indicatorName.indexOf('linkage') != -1) {\r\n\t\t\t\t\tfor (var j = 0; j < value.indicatorName.split('|').length; j++) {\r\n\t\t\t\t\t\tif (value.indicatorName.split('|')[j].indexOf('linkage') != -1) {\r\n\t\t\t\t\t\t\turlObject['parentId'] = value.indicatorName.split('|')[j].replace(/[^0-9]/ig, \"\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\turlObject['linkageType'] = 'url';\r\n\t\t\t\t\tlinkageConfig.push(urlObject);\r\n\t\t\t\t}\r\n\t\t\t\tconfigObj.urlConfig.push(urlObject);\r\n\t\t\t\tif (value.url == null) {\r\n\t\t\t\t\tvalue.url = 'http://www.baidu.com'\r\n\t\t\t\t}\r\n\t\t\t\tstr += `<div class=\"layui-col-lg12\">\r\n \t\t\t\t\t\t\t<label class=\"layui-form-label\">${value.indicatorCname}</label>\r\n \t\t\t\t\t\t\t<div class=\"layui-input-block\" style=\"padding-top: 5px;\">`\r\n\t\t\t\tlet globalVariableFlag = false;\r\n\t\t\t\tif (value.indicatorName && value.indicatorName.indexOf('|pay|') != -1) {//支付必须先提交\r\n\t\t\t\t\tstr += `<a id=\"evaluationScore${key+1}\" data=\"0\" onclick=\"firstSubmit('${value.url}',this)\" >点我进入${value.indicatorCname}</a>`\r\n\t\t\t\t} else if (value.indicatorName && value.indicatorName.indexOf('|linkage') != -1) {//联动框\r\n\t\t\t\t\tstr += `<a id=\"evaluationScore${key+1}\" target=\"_blank\" ></a>`;\r\n\t\t\t\t} else if (value.indicatorName && value.indicatorName.indexOf('|current|') != -1 || value.indicatorName == 'current') {//当前登录\r\n\t\t\t\t\tstr += `<a id=\"evaluationScore${key+1}\" target=\"_blank\" >点我进入${value.indicatorCname}</a>`;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstr += `<a id=\"evaluationScore${key+1}\" href=\"${value.url}?username=${currentUsername}\" target=\"_blank\">点我进入${value.indicatorCname}</a>`;\r\n\t\t\t\t}\r\n\t\t\t\tstr += `</div></div>`;\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn str;\r\n\t}\r\n\t//上传附件\r\n\twindow.uploadFileMeeting = function (index,step) {\r\n\t\tlet temp = `学生成果上传_${currentUsername}`\r\n\t\topenUploadWindowByPath('配置中心/学业导师/'+temp,index,step);\r\n\t};\r\n\tfunction configRender() {\r\n\t\t$.each(configObj.fileConfig,function (index, item) {\r\n\t\t\t//导入\r\n\t\t\tvar pblist = $(`#pblist${item.index}`),\r\n\t\t\t\tuploadListIns = upload.render({\r\n\t\t\t\t\telem: `#uploadFile${item.index}`,\r\n\t\t\t\t\turl: '/upload/', //上传接口\r\n\t\t\t\t\taccept: 'file', //所有文件\r\n\t\t\t\t\tmultiple: true, //多个上传\r\n\t\t\t\t\tauto: false, //是否直接选择文件后上传\r\n\t\t\t\t\tdata: {isLayui: false},\r\n\t\t\t\t\tbindAction: `#uploadfilesbtn${item.index}`, //上传按钮\r\n\t\t\t\t\tchoose: function(obj) {\r\n\t\t\t\t\t\tvar files = this.files = obj.pushFile(); //将每次选择的文件追加到文件队列\r\n\t\t\t\t\t\t//读取本地文件\r\n\t\t\t\t\t\tobj.preview(function(index, file, result) {\r\n\t\t\t\t\t\t\tvar tr = $(['<tr id=\"upload-' + index + '\">', '<td class=\"wordbreak\">' + file.name + '</td>', '<td>' + (file.size / 1014).toFixed(1) + 'kb</td>', '<td>等待上传</td>', '<td>', '<button class=\"layui-btn layui-btn-xs demo-reload\" onClick=\"return false;\">重传</button>', '<button class=\"layui-btn layui-btn-xs layui-btn-danger demo-delete\">删除</button>', '</td>', '</tr>'].join(''));\r\n\r\n\t\t\t\t\t\t\t//单个重传\r\n\t\t\t\t\t\t\ttr.find('.demo-reload').on('click', function() {\r\n\t\t\t\t\t\t\t\tobj.upload(index, file);\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t//删除\r\n\t\t\t\t\t\t\ttr.find('.demo-delete').on('click', function() {\r\n\t\t\t\t\t\t\t\tdelete files[index]; //删除对应的文件\r\n\t\t\t\t\t\t\t\ttr.remove();\r\n\t\t\t\t\t\t\t\tuploadListIns.config.elem.next()[0].value = ''; //清空 input file 值，以免删除后出现同名文件不可选\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\tpblist.append(tr);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdone: function(res, index, upload) {\r\n\t\t\t\t\t\tif(res.code == 0) { //上传成功\r\n\t\t\t\t\t\t\tvar tr = pblist.find('tr#upload-' + index),\r\n\t\t\t\t\t\t\t\ttds = tr.children();\r\n\t\t\t\t\t\t\ttds.eq(2).html('<span style=\"color: #5FB878;\">上传成功</span>');\r\n\t\t\t\t\t\t\ttds.eq(3).html(''); //清空操作\r\n\t\t\t\t\t\t\treturn delete this.files[index]; //删除文件队列已经上传成功的文件\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.error(index, upload);\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function(index, upload) {\r\n\t\t\t\t\t\tvar tr = pblist.find('tr#upload-' + index),\r\n\t\t\t\t\t\t\ttds = tr.children();\r\n\t\t\t\t\t\ttds.eq(2).html('<span style=\"color: #FF5722;\">上传失败</span>');\r\n\t\t\t\t\t\ttds.eq(3).find('.demo-reload').removeClass('layui-hide'); //显示重传\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\tuploadIndexs.push(pblist);\r\n\t\t})\r\n\t\t//单选框\r\n\t\t$.each(configObj.selectConfig,function (index,item) {\r\n\t\t\t// var url = zuulHost+item.url;\r\n\t\t\t// var regex = /^http(s)?:\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- ./?%&=]*)?$/;\r\n\t\t\tif(!item.url){\r\n\t\t\t\t$.each(item.configIndicatorDTOS,function (i, d) {\r\n\t\t\t\t\t$('#selectConfig'+item.index).append(new Option(d.indicatorCname, d.id));// 下拉菜单里添加元素\r\n\t\t\t\t});\r\n\t\t\t\tform.render(\"select\");\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tvar regex = new RegExp(\"http\");\r\n\t\t\tif(item.url && regex.test(item.url)){\r\n\t\t\t\tvar url =item.url;\r\n\t\t\t}else{\r\n\t\t\t\tvar url=zuulHost+item.url;\r\n\t\t\t}\r\n\t\t\tif(item.type.indexOf('|current|')!=-1){\r\n\t\t\t\turl += url.indexOf('?')!=-1 ? '&username='+currusername : '?username='+currusername\r\n\t\t\t}\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: url,\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tasync: false,\r\n\t\t\t\ttype: 'post',\r\n\t\t\t\t// headers: {\"x-datasource\": \"limsproduct\"},\r\n\t\t\t\tsuccess: function (res) {\r\n\t\t\t\t\t// console.log(res)\r\n\t\t\t\t\t$.each(res.data, function (i, d) {\r\n\t\t\t\t\t\t$('#selectConfig'+item.index).append(new Option(d.text, d.id));// 下拉菜单里添加元素\r\n\t\t\t\t\t});\r\n\t\t\t\t\tform.render(\"select\");\r\n\t\t\t\t\tif(item.type.indexOf('|linkage|')!=-1){\r\n\t\t\t\t\t\tlet filter = 'select'+item.index;\r\n\t\t\t\t\t\tform.on('select('+filter+')', function(data){\r\n\t\t\t\t\t\t\tconsole.log(data.value); //得到被选中的值\r\n\t\t\t\t\t\t\tvar son;\r\n\t\t\t\t\t\t\t$.each(linkageConfig,function (i,d) {\r\n\t\t\t\t\t\t\t\t// })\r\n\t\t\t\t\t\t\t\tswitch (d.linkageType) {\r\n\t\t\t\t\t\t\t\t\tcase 'select' :\r\n\t\t\t\t\t\t\t\t\t\tif(item.id == d.parentId){\r\n\t\t\t\t\t\t\t\t\t\t\tson = d;\r\n\t\t\t\t\t\t\t\t\t\t\t// var regex = /^http(s)?:\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- ./?%&=]*)?$/;\r\n\t\t\t\t\t\t\t\t\t\t\tvar regex =  new RegExp(\"http\");\r\n\t\t\t\t\t\t\t\t\t\t\tlet sonurl = son.url\r\n\t\t\t\t\t\t\t\t\t\t\tif(!regex.test(son.url)){\r\n\t\t\t\t\t\t\t\t\t\t\t\tsonurl = zuulHost + sonurl;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tsonurl += sonurl.indexOf('?')!=-1 ? '&id='+data.value : '?id='+data.value\r\n\t\t\t\t\t\t\t\t\t\t\tif(son.type.indexOf('|current|')!=-1){\r\n\t\t\t\t\t\t\t\t\t\t\t\tsonurl += '&username='+currusername\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\t\t\t\t\turl: sonurl,\r\n\t\t\t\t\t\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\t\t\t\t\t\tasync: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype: 'post',\r\n\t\t\t\t\t\t\t\t\t\t\t\tsuccess: function (res) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$('#selectConfig'+son.index).empty();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$('#selectConfig'+son.index).prepend('<option value=\"\">请选择</option>')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$.each(res.data, function (ii, dd) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$('#selectConfig'+son.index).append(new Option(dd.text, dd.id));// 下拉菜单里添加元素\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tform.render(\"select\");\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tcase 'text' :\r\n\t\t\t\t\t\t\t\t\t\t// $.each(textConfig,function (i,d) {\r\n\t\t\t\t\t\t\t\t\t\tif(item.id == d.parentId){\r\n\t\t\t\t\t\t\t\t\t\t\tson = d;\r\n\t\t\t\t\t\t\t\t\t\t\t// var regex = /^http(s)?:\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- ./?%&=]*)?$/;\r\n\t\t\t\t\t\t\t\t\t\t\tvar regex =  new RegExp(\"http\");\r\n\t\t\t\t\t\t\t\t\t\t\tlet sonurl = son.url\r\n\t\t\t\t\t\t\t\t\t\t\tif(!regex.test(son.url)){\r\n\t\t\t\t\t\t\t\t\t\t\t\tsonurl =zuulHost+sonurl;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\t\t\t\t\turl: sonurl+'?id='+data.value,\r\n\t\t\t\t\t\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\t\t\t\t\t\tasync: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype: 'get',\r\n\t\t\t\t\t\t\t\t\t\t\t\tsuccess: function (res) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// console.log(res)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar str = '';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(res.data.length>0){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$.each(res.data[0],function (i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstr+=i+'：'+res.data[0][i]+'\\n'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$('#textConfig'+son.index).text(str);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t// })\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tcase 'url' :\r\n\t\t\t\t\t\t\t\t\t\tif(item.id == d.parentId){\r\n\t\t\t\t\t\t\t\t\t\t\tson = d;\r\n\t\t\t\t\t\t\t\t\t\t\tif(son.url.indexOf('resourceCloud')!=-1){//教学平台课程资源展示\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet courseInfo = `${data.value}_${$(data.elem).find('option:selected').text()}`\r\n\t\t\t\t\t\t\t\t\t\t\t\t$('#evaluationScore'+son.index).text('点我查看课程资源');\r\n\t\t\t\t\t\t\t\t\t\t\t\t$('#evaluationScore'+son.index).attr('href',son.url + '?username=' + currentUsername + '&globalVariable=' + courseInfo);\r\n\t\t\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t\t\t// var regex = /^http(s)?:\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- ./?%&=]*)?$/;\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar regex =  new RegExp(\"http\");\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet sonurl = son.url\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(!regex.test(son.url)){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsonurl =zuulHost+sonurl;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\turl: sonurl+'?id='+data.value,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tasync: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'get',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: function (res) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// console.log(res)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar str = '';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(res.data.length>0){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$.each(res.data[0],function (i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(i == 'text')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstr+=res.data[0][i];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$('#evaluationScore'+son.index).text(str);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$('#evaluationScore'+son.index).attr('href',str);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tcase 'table' :\r\n\t\t\t\t\t\t\t\t\t\tif(item.id == d.parentId){\r\n\t\t\t\t\t\t\t\t\t\t\tson = d;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t//获取表头\r\n\t\t\t\t\t\t\t\t\t\tvar cols = [];\r\n\t\t\t\t\t\t\t\t\t\tvar listUrl = '';\r\n\t\t\t\t\t\t\t\t\t\tvar regex = new RegExp(\"http\");\r\n\t\t\t\t\t\t\t\t\t\tlistUrl += regex.test(son.url) ? son.url : zuulHost+son.url\r\n\t\t\t\t\t\t\t\t\t\tlistUrl += listUrl.indexOf('?')!=-1 ? '&timetableId='+data.value+'&templateId='+templateId : '?timetableId='+data.value+'&templateId='+templateId\r\n\t\t\t\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\t\t\t\turl:listUrl,\r\n\t\t\t\t\t\t\t\t\t\t\tasync:false,\r\n\t\t\t\t\t\t\t\t\t\t\tsuccess: function (res) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar coll = [];\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar col = [];\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(son.type.indexOf('|checkbox|')!=-1){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcol.push(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{type:'checkbox'},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tcol.push(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{title:'序号',minWidth:50,align: 'center',type:\"numbers\"},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// {field: 'name',title:'名称',minWidth:100,align: 'center'},\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t// $.each(res.data,function (index,item){\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(res.code==200&&res.data.length>0){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(res.data[0].infoMap!=null){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar infoIndex = 0;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$.each(res.data[0].infoMap,function (i,d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcol.push({field: 'header'+infoIndex, title:i,minWidth:100,align:'center'})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinfoIndex++;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}else if(res.code == 500){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlayer.msg(res.msg);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t// col.push(\r\n\t\t\t\t\t\t\t\t\t\t\t\t//     {title: '操作', align: 'center',width: 200, toolbar: '#toolbar'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t// );\r\n\t\t\t\t\t\t\t\t\t\t\t\tcoll.push(col);\r\n\t\t\t\t\t\t\t\t\t\t\t\tcols = coll;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\ttable.reload('evaluationScoreTable_'+son.index, {\r\n\t\t\t\t\t\t\t\t\t\t\turl: listUrl\r\n\t\t\t\t\t\t\t\t\t\t\t,cols: cols\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tdefault :\r\n\t\t\t\t\t\t\t\t\t\tconsole.error('未找到联动相关项!');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\t//多选\r\n\t\t$.each(configObj.multiSelectConfig,function (index,item) {\r\n\t\t\tvar multis = 'multiSelectConfig'+item.index;\r\n\t\t\t// var regex = /^http(s)?:\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- ./?%&=]*)?$/;\r\n\t\t\tvar regex = new RegExp(\"http\");\r\n\t\t\tif(regex.test(item.url)){\r\n\t\t\t\tvar url =item.url;\r\n\t\t\t}else{\r\n\t\t\t\tvar url=zuulHost+item.url;\r\n\t\t\t}\r\n\t\t\tif(item.type == 'current' || item.type.indexOf('|current|') != -1) {\r\n\t\t\t\turl += url.indexOf('?')!=-1 ? '&username='+currusername : '?username='+currusername\r\n\t\t\t}\r\n\t\t\tif(item.type.indexOf('|search|')!=-1){//数据过多需要筛选 远程搜索\r\n\t\t\t\tmultis = xmSelect.render({\r\n\t\t\t\t\tel: '#multiSelectConfig'+item.index,\r\n\t\t\t\t\tname: 'evaluationScore'+item.index,\r\n\t\t\t\t\tlayVerify: 'required',\r\n\t\t\t\t\tautoRow: true,\r\n\t\t\t\t\t// toolbar: { show: true,showIcon: false },\r\n\t\t\t\t\tfilterable: true,\r\n\t\t\t\t\tremoteSearch: true,\r\n\t\t\t\t\ttheme: {color: '#1E9FFF'},\r\n\t\t\t\t\tmodel: {icon: 'hidden'},\r\n\t\t\t\t\tremoteMethod: function(val, cb, show){\r\n\t\t\t\t\t\t//这里如果val为空, 则不触发搜索\r\n\t\t\t\t\t\tif(!val){\r\n\t\t\t\t\t\t\treturn cb([]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\turl = funcUrlDel('keyword',url);\r\n\t\t\t\t\t\turl += url.indexOf('?')!=-1 ? '&keyword='+val : '?keyword='+val\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: url,\r\n\t\t\t\t\t\t\tasync: false,\r\n\t\t\t\t\t\t\ttype: 'get',\r\n\t\t\t\t\t\t\t// headers: {\"x-datasource\": \"limsproduct\"},\r\n\t\t\t\t\t\t\tsuccess: function (res) {\r\n\t\t\t\t\t\t\t\tvar data1 = [];\r\n\t\t\t\t\t\t\t\t$.each(res.data, function (index, item) {\r\n\t\t\t\t\t\t\t\t\tvar d = {name: item.text,value: item.id};\r\n\t\t\t\t\t\t\t\t\tdata1.push(d);\r\n\t\t\t\t\t\t\t\t\t// str+='<option value=\"'+ item.id +'\">'+ item.text +'</option>'\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tcb(data1)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\tmultis = xmSelect.render({\r\n\t\t\t\t\tel: '#multiSelectConfig'+item.index,\r\n\t\t\t\t\tname: 'evaluationScore'+item.index,\r\n\t\t\t\t\tfilterable: true,\r\n\t\t\t\t\tlayVerify: 'required',\r\n\t\t\t\t\t// toolbar: {show: true, showIcon: false},\r\n\t\t\t\t\ttheme: {color: '#1E9FFF',},\r\n\t\t\t\t\tmodel: {icon: 'hidden',},\r\n\t\t\t\t\tdata: []\r\n\t\t\t\t});\r\n\t\t\t\tif(item.url!=null || item.url!=''){\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: url,\r\n\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\tasync: false,\r\n\t\t\t\t\t\ttype: 'post',\r\n\t\t\t\t\t\tsuccess: function (res) {\r\n\t\t\t\t\t\t\tvar data1 = [];\r\n\t\t\t\t\t\t\t$.each(res.data, function (index, item) {\r\n\t\t\t\t\t\t\t\tvar d = {name: item.text,value: item.id};\r\n\t\t\t\t\t\t\t\tdata1.push(d);\r\n\t\t\t\t\t\t\t\t// str+='<option value=\"'+ item.id +'\">'+ item.text +'</option>'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tmultis.update({\r\n\t\t\t\t\t\t\t\tdata:data1\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}else{\r\n\t\t\t\t\tvar data1 = [];\r\n\t\t\t\t\t$.each(item.configIndicatorDTOS,function (i, d) {\r\n\t\t\t\t\t\tvar o = {name: d.indicatorCname,value: d.id};\r\n\t\t\t\t\t\tdata1.push(o);\r\n\t\t\t\t\t\t// str+='<option value=\"'+ item.id +'\">'+ item.text +'</option>'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tmultis.update({\r\n\t\t\t\t\t\tdata:data1\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t//链接\r\n\t\t$.each(configObj.urlConfig,function (index,item) {\r\n\t\t\tvar url = '';\r\n\t\t\tif(item.url != null || item.url != '') {\r\n\t\t\t\tif (item.type == 'current' || item.type.indexOf('|current|') != -1) {\r\n\t\t\t\t\t// var regex = /^http(s)?:\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- ./?%&=]*)?$/;\r\n\t\t\t\t\tvar regex = new RegExp(\"http\");\r\n\t\t\t\t\tif (regex.test(item.url)) {\r\n\t\t\t\t\t\turl += item.url;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\turl += zuulHost + item.url;\r\n\t\t\t\t\t}\r\n\t\t\t\t\turl += url.indexOf('?')!=-1 ? '&username='+currusername : '?username='+currusername\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: url,\r\n\t\t\t\t\t\t// dataType: 'json',\r\n\t\t\t\t\t\tasync: false,\r\n\t\t\t\t\t\ttype: 'get',\r\n\t\t\t\t\t\tsuccess: function (res) {\r\n\t\t\t\t\t\t\tif (Array.isArray(res.data)) {\r\n\t\t\t\t\t\t\t\t// $('#evaluationScore'+item.index).text(res.data[0].text);\r\n\t\t\t\t\t\t\t\t$('#evaluationScore' + item.index).attr('href', res.data[0].text);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// $('#evaluationScore'+item.index).text(res.data.text);\r\n\t\t\t\t\t\t\t\t$('#evaluationScore' + item.index).attr('href', res.data.text);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// console.log(res)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t//文本框\r\n\t\t$.each(configObj.textConfig,function (index,item) {\r\n\t\t\tvar url = '';\r\n\t\t\tif(item.url != null || item.url != '') {\r\n\t\t\t\tif (item.type == 'current' || item.type.indexOf('|current|') != -1) {\r\n\t\t\t\t\t// var regex = /^http(s)?:\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- ./?%&=]*)?$/;\r\n\t\t\t\t\tvar regex = new RegExp(\"http\");\r\n\t\t\t\t\tif (regex.test(item.url)) {\r\n\t\t\t\t\t\turl += item.url;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\turl += zuulHost + item.url;\r\n\t\t\t\t\t}\r\n\t\t\t\t\turl += url.indexOf('?')!=-1 ? '&username='+currusername : '?username='+currusername\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: url,\r\n\t\t\t\t\t\t// dataType: 'json',\r\n\t\t\t\t\t\tasync: false,\r\n\t\t\t\t\t\ttype: 'get',\r\n\t\t\t\t\t\tsuccess: function (res) {\r\n\t\t\t\t\t\t\tif (Array.isArray(res.data)) {\r\n\t\t\t\t\t\t\t\t$('#textConfig'+item.index).text(res.data[0].text)\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$('#textConfig'+item.index).text(res.data.text)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// console.log(res)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t$('#textConfig'+item.index).textareafullscreen();\r\n\t\t});\r\n\t\t//副文本框\r\n\t\t$.each(configObj.editorConfig,function (index,item) {\r\n\t\t\t//建立编辑器\r\n\t\t\tvar editorIndex = layedit.build(`editorConfig${item.index}`, {\r\n\t\t\t\theight: 288 //设置编辑器高度\r\n\t\t\t\t,\r\n\t\t\t\ttool: [\r\n\t\t\t\t\t'strong' //加粗\r\n\t\t\t\t\t, 'italic' //斜体\r\n\t\t\t\t\t, 'underline' //下划线\r\n\t\t\t\t\t, 'del' //删除线\r\n\t\t\t\t\t, '|' //分割线\r\n\t\t\t\t\t, 'left' //左对齐\r\n\t\t\t\t\t, 'center' //居中对齐\r\n\t\t\t\t\t, 'right' //右对齐\r\n\t\t\t\t\t, '|' //分割线\r\n\t\t\t\t\t, 'link' //超链接\r\n\t\t\t\t\t, 'unlink' //清除链接\r\n\t\t\t\t\t// , 'image' //插入图片\r\n\t\t\t\t]\r\n\t\t\t});\r\n\t\t\teditorIndexs.push(editorIndex);\r\n\t\t});\r\n\r\n\t\t//日期\r\n\t\t$.each(configObj.dateConfig,function (index,item) {\r\n\t\t\tif(item.indicatorName && item.indicatorName.indexOf('|currentDate|')!=-1){\r\n\t\t\t\tlaydate.render({\r\n\t\t\t\t\telem: '#dateConfig'+item.index,\r\n\t\t\t\t\ttrigger: 'click',\r\n\t\t\t\t\tvalue: new Date(),\r\n\t\t\t\t});\r\n\t\t\t\t$('#dateConfig'+item.index).attr('disabled','disabled');\r\n\t\t\t}else if(item.indicatorName && item.indicatorName.indexOf('|wednesday|')!=-1){\r\n\t\t\t\tlet weekday = getDay(new Date());\r\n\t\t\t\tlaydate.render({\r\n\t\t\t\t\telem: '#dateConfig'+item.index,\r\n\t\t\t\t\ttrigger: 'click',\r\n\t\t\t\t\tvalue: weekday,\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\tlaydate.render({\r\n\t\t\t\t\telem: '#dateConfig'+item.index,\r\n\t\t\t\t\ttrigger: 'click',\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t\t//日期时间\r\n\t\t$.each(configObj.dateTimeConfig,function (index,item) {\r\n\t\t\tif(item.indicatorName && item.indicatorName.indexOf('|current|')!=-1){\r\n\t\t\t\tlaydate.render({\r\n\t\t\t\t\telem: '#dateTimeConfig'+item.index,\r\n\t\t\t\t\ttype: 'datetime',\r\n\t\t\t\t\ttrigger: 'click',\r\n\t\t\t\t\tvalue: new Date()\r\n\t\t\t\t});\r\n\t\t\t\t$('#dateTimeConfig'+item.index).attr('disabled','disabled');\r\n\t\t\t\tsetInterval(function () {\r\n\t\t\t\t\tvar date = new Date();\r\n\t\t\t\t\tvar y = date.getFullYear();\r\n\t\t\t\t\tvar m = date.getMonth()+1;\r\n\t\t\t\t\tvar d = date.getDate();\r\n\t\t\t\t\tvar h = date.getHours();\r\n\t\t\t\t\tvar min = date.getMinutes();\r\n\t\t\t\t\tvar s = date.getSeconds();\r\n\t\t\t\t\tvar str=y+'-'+(m<10?('0'+m):m)+'-'+(d<10?('0'+d):d)+'  '+(h<10?('0'+h):h)+':'+(min<10?('0'+min):min)+':'+(s<10?('0'+s):s);\r\n\t\t\t\t\t$('#dateTimeConfig'+item.index).val(str);\r\n\t\t\t\t}, 1000);\r\n\t\t\t}else{\r\n\t\t\t\tlaydate.render({\r\n\t\t\t\t\telem: '#dateTimeConfig'+item.index,\r\n\t\t\t\t\ttype: 'datetime',\r\n\t\t\t\t\ttrigger: 'click',\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t\t//日期范围\r\n\t\t$.each(configObj.rangeDateConfig,function (index,item) {\r\n\t\t\tlaydate.render({\r\n\t\t\t\telem: '#rangeDateConfig'+item.index,\r\n\t\t\t\ttrigger: 'click'\r\n\t\t\t\t// min:minDate()\r\n\t\t\t\t, range: '~'\r\n\t\t\t});\r\n\t\t});\r\n\t\t//日期时间范围\r\n\t\t$.each(configObj.rangeDateTimeConfig,function (index,item) {\r\n\t\t\tlaydate.render({\r\n\t\t\t\telem: '#rangeDateTimeConfig'+item.index\r\n\t\t\t\t,trigger: 'click'\r\n\t\t\t\t,type: 'datetime'\r\n\t\t\t\t// min:minDate()\r\n\t\t\t\t, range: '~'\r\n\t\t\t});\r\n\t\t});\r\n\t\twindow.getDay = function (dd) {\r\n\t\t\tvar week = dd.getDay(); //获取时间的星期数\r\n\t\t\tvar minus = (week - 3) >= 0 ? -(7- week + 3) : week - 3;\r\n\t\t\tdd.setDate(dd.getDate() - minus); //获取minus天前的日期\r\n\t\t\tvar y = dd.getFullYear();\r\n\t\t\tvar m = dd.getMonth() + 1; //获取月份\r\n\t\t\tvar d = dd.getDate();\r\n\t\t\treturn y + \"-\" + m + \"-\" + d;\r\n\t\t}\r\n\t}\r\n\tfunction getWorkResult(configIndicators,data) {\r\n\t\tlet str = `<div class=\"case_main_tit\">\r\n\t\t\t\t\t\t<input type=\"button\" class=\"layui-input readinputbtn\" autocomplete=\"off\" disabled=\"disabled\" readonly=\"readonly\" value=\"个人成果\" />\r\n\t\t\t\t\t</div>`\r\n\t\t$.each(configIndicators, function (key, value) {\r\n\t\t\tlet evaluationScore = 'evaluationScore'+(key+1);\r\n\t\t\tif(value.contentType !== 'file'){\r\n\t\t\t\tstr+=`<div class=\"case_nav\">\r\n\t\t\t\t\t\t<div class=\"case_nav_tit\">${value.indicatorCname}</div>\r\n\t\t\t\t\t\t<input type=\"button\" class=\"layui-input readinputbtn\" autocomplete=\"off\" disabled=\"disabled\" readonly=\"readonly\" value=\"${data[evaluationScore]}\"/>\r\n\t\t\t\t\t\t\t\t<!--调试时可暂时把disabled与readonly删除。此行仅为提示，可删。-->\r\n\t\t\t\t\t</div>`\r\n\t\t\t}else{\r\n\t\t\t\tstr+=`<div class=\"case_nav\">\r\n\t\t\t\t\t\t<div class=\"case_nav_tit\">文件资料\r\n\t\t\t\t\t\t\t<div class=\"layui-inline font_normal mt0-5\">\r\n\t\t\t\t\t\t\t\t<input type=\"button\" class=\"layui-btn layui-btn-xs\" value=\"全部下载\">\r\n\t\t\t\t\t\t\t\t<input type=\"button\" class=\"layui-btn layui-btn-xs layui-btn-green\" value=\"所选文件下载\">\r\n\t\t\t\t\t\t\t\t<input type=\"text\" class=\"startvalue\" hidden=\"\" placeholder=\"shift键选择\" />\r\n\t\t\t\t\t\t\t\t<input type=\"text\" class=\"ivalue\" hidden=\"\" placeholder=\"ctrl键选择\" />\r\n\t\t\t\t\t\t\t\t<font class=\"font_grey\">(可按住ctrl键点选或按住shift键连选)</font>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"pictext_box opacity_box mt10\">`\r\n\t\t\t\t\t\t$.each(data[evaluationScore].split(','),function (index, item) {\r\n\t\t\t\t\t\t\tstr+=`<div class=\"pictext_net opacity1\" title=\"${item.split('_')[item.split('_').length-1]}\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"pn_img_box\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"pn_img\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"/teacherInformationCenter/modules/configcenter/static/images/audio.png\">\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"pn_info\">${item.split('_')[item.split('_').length-1]}</div>\r\n\t\t\t\t\t\t\t\t\t</div>`\r\n\t\t\t\t\t\t});\r\n\t\t\t\tstr+=`</div>\r\n\t\t\t\t\t</div>`\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn str;\r\n\t}\r\n});\r\n\r\n//工作成果编辑查看\r\n$(\".editachievementboxbtn\").click(\r\n\tfunction() {\r\n\t\t$(\".editachievementbox\").show();\r\n\t\t$(\".showachievementbox\").hide();\r\n\t}\r\n);\r\n\r\n// $(\".saveachievementboxbtn\").click(\r\n// \tfunction() {\r\n// \t\t$(\".showachievementbox\").show();\r\n// \t\t$(\".editachievementbox\").hide();\r\n// \t}\r\n// );\r\n\r\n$(\".cancelachievementboxbtn\").click(\r\n\tfunction() {\r\n\t\t$(\".showachievementbox\").show();\r\n\t\t$(\".editachievementbox\").hide();\r\n\t}\r\n);\r\n\r\n//传递子页面锚\r\n$(function() {\r\n\t$(\".layui-tab-title li a\").click(function() {\r\n\t\tvar name = $(this).attr(\"name\");\r\n\t\ttop.location.hash = name; //设置锚点\r\n\t});\r\n});
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/gvsun-business/provider-api/usercenter-front/src/main/resources/static/modules/configcenter/registration/editAcademicStudentWorkAchievement.js b/gvsun-business/provider-api/usercenter-front/src/main/resources/static/modules/configcenter/registration/editAcademicStudentWorkAchievement.js
--- a/gvsun-business/provider-api/usercenter-front/src/main/resources/static/modules/configcenter/registration/editAcademicStudentWorkAchievement.js	
+++ b/gvsun-business/provider-api/usercenter-front/src/main/resources/static/modules/configcenter/registration/editAcademicStudentWorkAchievement.js	
@@ -76,19 +76,10 @@
 			success: function (res) {
 				// console.log(res);
 				timetableProcessId = res.data[0].timetableProcessDTOS[3].timetableProcessId;
-				// //获取表单
-				// let formstr = '';
-				// formstr = configString(res.data[0].timetableProcessDTOS[3]);
-				// $('.editachievementbox').find('.layui-row').html(formstr);
-				//获取结果
-				let resultstr = '';
-				$.each(res.data[0].timetableProcessDTOS[3].timetableResults,function (key, value) {
-					if(value.initiatorUsername === currentUsername){
-						resultstr+=getWorkResult(res.data[0].timetableProcessDTOS[3].configIndicators,value);
-					}
-				})
-				$('.case_box').html(resultstr);
-				// configRender();
+				let str = '';
+				str = configString(res.data[0].timetableProcessDTOS[3].configIndicators);
+				$('.editachievementbox').find('.layui-row').html(str);
+				configRender()
 				resolve('getResult Success')
 			}
 		});
@@ -100,87 +91,12 @@
 		console.log(error)
 	})
 	//信息
-	// form.val('editacademicstudentworkachievementbox', {
-	// 	"name": "我是名称",
-	// 	"info": "我是简介/我是简介/我是简介/我是简介/我是简介/",
-	// 	"teaminfo": "我是团队介绍/我是团队介绍/我是团队介绍/我是团队介绍/我是团队介绍/",
-	// });
-//监听提交
-	form.on('submit(saveachievementboxbtn)', function(data) {
-
-		var d1 = data.field;
-		var configIndicatorDTOss = [];
-		// console.log(d1);
-		$.each(configObj.multiSelectConfig,function (index,item){
-			var xmList = xmSelect.get('#multiSelectConfig'+item.index);
-			var valueArr = xmList[0].getValue('value');
-			var nameArr = xmList[0].getValue('name');
-			var str = '';
-			$.each(valueArr,function (i,d) {
-				str+=d+'_'+nameArr[i]+',';
-			});
-			str = str.slice(0,str.length-1);
-			// d1['evaluationScore'+item.index] = xmList[0].getValue('valueStr')+'_'+xmList[0].getValue('nameStr')
-			d1['evaluationScore'+item.index] = str;
-		});
-		$.each(configObj.selectConfig,function (index,item) {
-			d1['evaluationScore'+item.index] += '_'+$('#selectConfig'+item.index).find("option:selected").text();
-		});
-		$.each(configObj.checkboxConfig,function (index,item) {
-			let tasks = '';
-			$('input[name="evaluationScore'+ item.index +'"]:checked').each(function() { //遍历所有被选中的name为selectFlag的 checkbox
-				tasks+=$(this).val()+'_'+$(this).attr('title')+',';
-			});
-			tasks = (tasks.substring(tasks.length - 1) == ',') ? tasks.substring(0, tasks.length - 1) : tasks
-			d1['evaluationScore'+item.index] = tasks;
-		});
-		$.each(configObj.urlConfig,function (index,item) {
-			if(item.type.indexOf('|pay|')!=-1){
-				var isPay = $('#evaluationScore'+item.index).attr('data');
-				d1['evaluationScore'+item.index] = isPay;
-			}else {
-				d1['evaluationScore'+item.index] = $('#evaluationScore'+item.index).attr('href')
-			}
-		});
-		// console.log(d1);
-		saveTimetable(d1);
+	form.val('editacademicstudentworkachievementbox', {
+		"name": "我是名称",
+		"info": "我是简介/我是简介/我是简介/我是简介/我是简介/",
+		"teaminfo": "我是团队介绍/我是团队介绍/我是团队介绍/我是团队介绍/我是团队介绍/",
 	});
-	function saveTimetable(d1) {
-		let timetableResultDTO = new Object();
-		d1['timetableProcessId'] = timetableProcessId;
-		d1['initiatorUsername'] = currentUsername;
-		timetableResultDTO['timetableResult'] = d1;
-		timetableResultDTO['submitUser'] = currentUsername;
-		timetableResultDTO['stageId'] = 1;
-		timetableResultDTO['isComplete'] = -1;
-		timetableResultDTO['timetableProcessId'] = timetableProcessId;
-		var data = JSON.stringify(timetableResultDTO);
-		// 保存
-		$.ajax({
-			// url:zuulUrl+'api/meetingProcess/saveMeetingProcess',
-			url:evaluationHost+'api/timetableResult/resultNew',
-			dataType: 'json',
-			data: data,
-			type: 'post',
-			// async: false,
-			contentType:"application/json;charset=utf-8",
-			success:function (res) {
-				// console.log(res);
-				if(res.code == '200'){
-					layer.msg('保存成功');
-					$(".showachievementbox").show();
-					$(".editachievementbox").hide();
-				}else{
-					layer.msg(res.msg);
-					return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。
-				}
-			},
-			error: function () {
-				alert("后台保存数据报错");
-				return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。
-			}
-		});
-	}
+
 	//上传文件，选完文件后不自动上传,点击开始上传按钮上传
 
 
@@ -372,8 +288,8 @@
 // 							</div>
 // 						</div>
 // 						</div>-->
-<button type="button" class="layui-btn" onclick="uploadFileMeeting(${(key + 1)},3)">上传附件</button>
-					 <input id="fileUpload${ (key + 1)}_3" name="evaluationScore${ (key + 1)}" class="layui-input layui-disabled" disabled=""/>
+<button type="button" class="layui-btn" onclick="uploadFileMeeting(${(key + 1)},${step})">上传附件</button>
+					 <input id="fileUpload${ (key + 1)}_${step}" name="evaluationScore${ (key + 1)}" class="layui-input layui-disabled" disabled=""/>
 					 </div></div>`;
 			}else if(value.contentType === 'url'){
 				let urlObject = new Object();
@@ -921,46 +837,6 @@
 			return y + "-" + m + "-" + d;
 		}
 	}
-	function getWorkResult(configIndicators,data) {
-		let str = `<div class="case_main_tit">
-						<input type="button" class="layui-input readinputbtn" autocomplete="off" disabled="disabled" readonly="readonly" value="个人成果" />
-					</div>`
-		$.each(configIndicators, function (key, value) {
-			let evaluationScore = 'evaluationScore'+(key+1);
-			if(value.contentType !== 'file'){
-				str+=`<div class="case_nav">
-						<div class="case_nav_tit">${value.indicatorCname}</div>
-						<input type="button" class="layui-input readinputbtn" autocomplete="off" disabled="disabled" readonly="readonly" value="${data[evaluationScore]}"/>
-								<!--调试时可暂时把disabled与readonly删除。此行仅为提示，可删。-->
-					</div>`
-			}else{
-				str+=`<div class="case_nav">
-						<div class="case_nav_tit">文件资料
-							<div class="layui-inline font_normal mt0-5">
-								<input type="button" class="layui-btn layui-btn-xs" value="全部下载">
-								<input type="button" class="layui-btn layui-btn-xs layui-btn-green" value="所选文件下载">
-								<input type="text" class="startvalue" hidden="" placeholder="shift键选择" />
-								<input type="text" class="ivalue" hidden="" placeholder="ctrl键选择" />
-								<font class="font_grey">(可按住ctrl键点选或按住shift键连选)</font>
-							</div>
-						</div>
-						<div class="pictext_box opacity_box mt10">`
-						$.each(data[evaluationScore].split(','),function (index, item) {
-							str+=`<div class="pictext_net opacity1" title="${item.split('_')[item.split('_').length-1]}">
-										<div class="pn_img_box">
-											<div class="pn_img">
-												<img src="/teacherInformationCenter/modules/configcenter/static/images/audio.png">
-											</div>
-										</div>
-										<div class="pn_info">${item.split('_')[item.split('_').length-1]}</div>
-									</div>`
-						});
-				str+=`</div>
-					</div>`
-			}
-		})
-		return str;
-	}
 });
 
 //工作成果编辑查看
@@ -971,12 +847,12 @@
 	}
 );
 
-// $(".saveachievementboxbtn").click(
-// 	function() {
-// 		$(".showachievementbox").show();
-// 		$(".editachievementbox").hide();
-// 	}
-// );
+$(".saveachievementboxbtn").click(
+	function() {
+		$(".showachievementbox").show();
+		$(".editachievementbox").hide();
+	}
+);
 
 $(".cancelachievementboxbtn").click(
 	function() {
